<!DOCTYPE html>
<html lang="fa" dir="rtl">
<!-- ุจุฎุด ูุฏุฑ -->
<header th:insert="fragments/header.html :: header('ุฏฺฉุชุฑุขูพ | ุฎุงูู', '/css/index.css')"></header>
<body>
<main>
    <!-- ุจุฎุด ููุงุฑ ูุงูุจุฑ -->
    <nav th:insert="fragments/navbar.html :: navbar"></nav>

    <!-- ุจุฎุด ุฌุณุชุฌู -->
    <section class="section_container" style="text-align: center; padding: 50px 20px; background: #f9f9f9;">
        <div class="search_txt" style="margin-bottom: 20px;">
            <h1 style="font-family: 'Vazir', sans-serif; font-size: 2rem; color: #333;">ูพุฒุดฺฉ ููุงุณุจ ุฎูุฏ ุฑุง ุจูโุณุงุฏฺฏ ุจุงุจุฏ ู ููุจุช ุฎูุฏ ุฑุง ุขููุงู ุฑุฒุฑู ฺฉูุฏ.</h1>
            <p style="color: #555; font-size: 1.1rem;">ุฏุฑ ูุณุฑ ุณูุงูุชุ ูุง ุดูุง ุฑุง ุจู ุจูุชุฑู ูพุฒุดฺฉุงู ูุชุตู ูโฺฉูู.</p>
        </div>

        <div class="search_box" style="display: flex; justify-content: center; flex-wrap: wrap; gap: 10px;">
            <form id="searchForm" action="/search" method="GET" style="display: flex; flex-wrap: wrap; gap: 10px;">

                <!-- ุงูุชุฎุงุจ ุงุณุชุงู -->
                <select id="division" name="division" style="padding: 1px; border-radius: 8px; border: 1px solid #ccc; min-width: 180px;">
                    <option value="">ุงูุชุฎุงุจ ุงุณุชุงู</option>
                    <th:block th:each="province : ${searchElement.getDivisionList()}">
                        <option th:value="${province}" th:text="${province}"></option>
                    </th:block>
                </select>

                <!-- ุงูุชุฎุงุจ ุดูุฑุณุชุงู (ูพูุง) -->
                <select id="district" name="district" style="padding: 1px; border-radius: 8px; border: 1px solid #ccc; min-width: 180px;" disabled>
                    <option value="">ุงุจุชุฏุง ุงุณุชุงู ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ</option>
                </select>

                <!-- ุงูุชุฎุงุจ ุชุฎุตุต -->
                <select id="specialty" name="specialty" style="padding: 1px; border-radius: 8px; border: 1px solid #ccc; min-width: 180px;">
                    <option value="">ุงูุชุฎุงุจ ุชุฎุตุต</option>
                    <th:block th:each="specialty : ${searchElement.getSpecialtyList()}">
                        <option th:value="${specialty}" th:text="${specialty}"></option>
                    </th:block>
                </select>

                <!-- ุฏฺฉูู ุฌุณุชุฌู -->
                <input type="submit" value="๐ ุฌุณุชุฌู" class="button_style"
                       style="background: #007bff; color: white; border: none; padding: 1px 1px; border-radius: 8px; cursor: pointer; font-weight: bold;">
            </form>
        </div>
    </section>

    <!-- ุจุฎุด ุชุตูุฑ ุงุตู -->
    <section style="margin-top: 30px; text-align: center;">
        <img class="hero_background" src="/img/hero_background.png" alt="ูพุณโุฒููู ุตูุญู"
             style="max-width: 90%; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
    </section>

    <br/><br/><br/>
</main>


<!-- ุงุถุงูู ฺฉุฑุฏู jQuery (ุงฺฏุฑ ูุจูุงู ุงุถุงูู ูุดุฏู) -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    $(document).ready(function () {
        const districtSelect = $('#district');
        const divisionSelect = $('#division');

        divisionSelect.change(function () {
            const selectedProvince = $(this).val();

            if (!selectedProvince) {
                districtSelect.prop('disabled', true).html('<option value="">ุงุจุชุฏุง ุงุณุชุงู ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ</option>');
                return;
            }

            districtSelect.prop('disabled', false).html('<option value="">ุฏุฑ ุญุงู ุจุงุฑฺฏุฐุงุฑ...</option>');

            $.ajax({
                url: '/api/districts/' + encodeURIComponent(selectedProvince),
                method: 'GET',
                dataType: 'json', // โญ ุงู ุฎุท ุฑู ุงุถุงูู ฺฉู
                success: function (districts) {
                    // ุญุงูุง ูุทูุฆูู districts ฺฉ ุขุฑุงู ุงุณุช
                    let options = '<option value="">ุงูุชุฎุงุจ ุดูุฑุณุชุงู</option>';

                    if (Array.isArray(districts) && districts.length > 0) {
                        districts.forEach(function (district) {
                            options += `<option value="${district}">${district}</option>`;
                        });
                    } else {
                        options += '<option disabled>ุดูุฑุณุชุงู ุงูุช ูุดุฏ</option>';
                    }
                    districtSelect.html(options);
                },
                error: function (xhr, status, error) {
                    console.error("ุฎุทุง ุฏุฑ ุจุงุฑฺฏุฐุงุฑ ุดูุฑุณุชุงูโูุง:", error);
                    districtSelect.html('<option value="">ุฎุทุง ุฏุฑ ุจุงุฑฺฏุฐุงุฑ</option>');
                }
            });
        });
    });
</script>
</body>
</html>